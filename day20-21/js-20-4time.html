<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>动画消失</title>
</head>
<body>
    <div id="fade-obj" style="width:300px;height:300px;background:#000;opacity: 1"></div>
    <button id="fade-btn">淡出</button>
    <script type="text/javascript">
        // var fDiv = document.getElementById("fade-obj");
        // // var fBtn = document.getElementById("fade-btn");
        // // 淡出
        // function fadeOut() {
        //     let i = 1;
        //     function setFadeOut() {
        //         if (i <= 0) {
        //             clearTimeout(setFadeOut);
        //             fBtn.removeAttribute("disabled");
        //             fBtn.innerHTML = "淡入";
        //             fDiv.style.opacity = 0;
        //         } else {
        //             i -= 0.05;
        //             fDiv.style.opacity = i;
        //             fBtn.setAttribute("disabled", true);
        //             console.log(i);
        //             setTimeout(setFadeOut, 100);
        //         }
        //     }
        //     setFadeOut();
        // }
        // // 淡入
        // function fadeIn() {
        //     let i = 0;
        //     function setFadeIn() {
        //         if (i >= 1) {
        //             clearTimeout(setFadeIn);
        //             fBtn.removeAttribute("disabled");
        //             fBtn.innerHTML = "淡出";
        //             fDiv.style.opacity = 1;
        //         } else {
        //             i +=0.05;
        //             fDiv.style.opacity = i;
        //             fBtn.setAttribute("disabled", true);
        //             console.log(i);
        //             setTimeout(setFadeIn, 100);
        //         }
        //     }
        //     setFadeIn();
        // }
        // // 执行函数的判断
        // fBtn.onclick = () => (fDiv.style.opacity == 1) ? fadeOut() : fadeIn();

        //setInterval 实现
        var fDiv = document.getElementById("fade-obj");
        var fBtn = document.getElementById("fade-btn");
        var steps = 50;
        var currentStep = 1;
        function fadeOut() {
            let timer = setInterval(() => {
                if (steps < currentStep) {
                    clearInterval(timer);
                    currentStep = 1;
                    fBtn.removeAttribute("disabled");
                    fBtn.innerHTML = "淡入";
                } else {
                    fDiv.style.opacity =1-1/steps*currentStep++;
                    fBtn.setAttribute("disabled", true);
                }
            },50)
        }
        function fadeIn() {
            let timer = setInterval(() => {
                if (steps < currentStep) {
                    clearInterval(timer);
                    currentStep =1;
                    fBtn.removeAttribute("disabled");
                    fBtn.innerHTML = "淡出";
                } else {
                    fDiv.style.opacity =1/steps*currentStep++;
                    fBtn.setAttribute("disabled", true);
                }
            },50)
        }

        fBtn.onclick = () => (fDiv.style.opacity == 1) ? fadeOut() : fadeIn();
    </script>
</body>
</html>